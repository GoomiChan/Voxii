var Voxii=function(){function e(e){console.time("visible voxels");for(var o=0,n=0;n<e.voxels.length;n++)e[n]!=e.nullColor&&o++;console.timeEnd("visible voxels"),console.log("solidBlocks: "+o),console.time("simpleMesher");for(var a=new THREE.BufferGeometry,i=new Float32Array(18*o*6),s=new Float32Array(12*o*6),n=0,l=0,d=0;d<e.dims.x;d++)for(var c=0;c<e.dims.y;c++)for(var h=0;h<e.dims.z;h++){var u=e.voxels[r.get3dArrayIdx(e.dims,d,c,h)];u!=e.nullColor&&((d+1>=e.dims.x||e.voxels[r.get3dArrayIdx(e.dims,d+1,c,h)]==e.nullColor)&&(i.set([1+d,0+c,0+h,1+d,1+c,0+h,1+d,1+c,1+h,1+d,1+c,1+h,1+d,0+c,1+h,1+d,0+c,0+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12),(0>d-1||e.voxels[r.get3dArrayIdx(e.dims,d-1,c,h)]==e.nullColor)&&(i.set([0+d,1+c,1+h,0+d,1+c,0+h,0+d,0+c,0+h,0+d,0+c,0+h,0+d,0+c,1+h,0+d,1+c,1+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12),(0>c-1||e.voxels[r.get3dArrayIdx(e.dims,d,c-1,h)]==e.nullColor)&&(i.set([0+d,0+c,0+h,1+d,0+c,0+h,1+d,0+c,1+h,1+d,0+c,1+h,0+d,0+c,1+h,0+d,0+c,0+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12),(c+1>=e.dims.y||e.voxels[r.get3dArrayIdx(e.dims,d,c+1,h)]==e.nullColor)&&(i.set([1+d,1+c,1+h,1+d,1+c,0+h,0+d,1+c,0+h,0+d,1+c,0+h,0+d,1+c,1+h,1+d,1+c,1+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12),(0>h-1||e.voxels[r.get3dArrayIdx(e.dims,d,c,h-1)]==e.nullColor)&&(i.set([0+d,1+c,0+h,1+d,1+c,0+h,1+d,0+c,0+h,0+d,0+c,0+h,0+d,1+c,0+h,1+d,0+c,0+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12),(h+1>=e.dims.z||e.voxels[r.get3dArrayIdx(e.dims,d,c,h+1)]==e.nullColor)&&(i.set([1+d,0+c,1+h,1+d,1+c,1+h,0+d,1+c,1+h,1+d,0+c,1+h,0+d,1+c,1+h,0+d,0+c,1+h],n),n+=18,s.set(t(u,e.numColors),l),l+=12))}return i=new Float32Array(i,n),s=new Float32Array(s,l),a.addAttribute("position",new THREE.BufferAttribute(i,3)),a.addAttribute("uv",new THREE.BufferAttribute(s,2)),a.computeVertexNormals(),console.timeEnd("simpleMesher"),a}function t(e,t){var o=1/t,n=o*e;return[n+1e-4,1,n+1e-4,1,n+1e-4,0,n+1e-4,1,n+1e-4,0,n+1e-4,1,n+1e-4,1,n+1e-4,1]}function o(e){for(var t=new Uint8Array(4*e.length),o=0;o<e.length;o++){var n=e[o];t[4*o]=255&n,t[4*o+1]=n>>8&255,t[4*o+2]=n>>16&255,t[4*o+3]=n>>24&255}var a=new THREE.DataTexture(t,e.length,1,THREE.RGBAFormat);return a.needsUpdate=!0,a.wrapS=a.wrapT=THREE.ClampToEdgeWrapping,a.magFilter=THREE.NearestFilter,a.minFilter=THREE.NearestFilter,a}function n(e){for(var t=new THREE.Group,o=0;o<e.length;o++){var n=a(e[o]);t.add(n)}return t}function a(t){var n=o(t.palette),a=new THREE.MeshLambertMaterial({color:16777215,map:n});a.shading=THREE.SmoothShading;var i=new THREE.Mesh(e(t),a);t.pos&&i.position.set(t.pos.x+t.dims.x/2,t.pos.y,t.pos.z),i.castShadow=!0;var r=new THREE.Mesh(new THREE.BoxGeometry(t.dims.x,t.dims.y,t.dims.z),new THREE.MeshBasicMaterial({color:8947848,wireframe:!0}));return r.position.set(-.5,-.5,t.dims.z/2),r.name="bbox",r.visible=!1,i.add(r),i.geometry.applyMatrix((new THREE.Matrix4).makeTranslation(-t.dims.x/2,-t.dims.y/2,-t.dims.z/2)),i.rotation.x=t.rotateY*(Math.PI/180),i}function i(e,t){var o=e.split(".").pop().toLowerCase(),n=-1;if("vox"==o){var a=t.getString(4);n="VOX "==a?s.VOX:s.SLAB}else"qb"==o&&(n=s.QB);return t.seek(0),n}var r={},s={SLAB:0,VOX:1,QB:2};return r.Test=function(e){ConPrint("Voxii::Test")},r.LoadModel=function(e,t,o){function a(o){var a=new jDataView(o,0,o.length,!0),l=i(e,a);console.time("Load Model");var d=null;l==s.VOX?d=r.LoadVox(a,o.byteLength):l==s.SLAB?d=r.LoadSlab(a,o.byteLength):l==s.QB?d=r.LoadQb(a,o.byteLength):console.error("Voxel model format is not suported, sorry :<"),console.timeEnd("Load Model");var c=n(d);t(c,d)}if(o)a(o);else{var l=new THREE.XHRLoader;l.setResponseType("arraybuffer"),l.load(e,function(e){a(e)})}},r.get3dArrayIdx=function(e,t,o,n){return t*e.y*e.z+o*e.z+n},r}();!function(e){function t(e){var t={};return t.id=e.getString(4),t.size=e.getInt32(),t.childSize=e.getInt32(),t}var o=[0,4294967295,4291624959,4288282623,4284940287,4281597951,4278255615,4294954239,4291611903,4288269567,4284927231,4281584895,4278242559,4294941183,4291598847,4288256511,4284914175,4281571839,4278229503,4294928127,4291585791,4288243455,4284901119,4281558783,4278216447,4294915071,4291572735,4288230399,4284888063,4281545727,4278203391,4294902015,4291559679,4288217343,4284875007,4281532671,4278190335,4294967244,4291624908,4288282572,4284940236,4281597900,4278255564,4294954188,4291611852,4288269516,4284927180,4281584844,4278242508,4294941132,4291598796,4288256460,4284914124,4281571788,4278229452,4294928076,4291585740,4288243404,4284901068,4281558732,4278216396,4294915020,4291572684,4288230348,4284888012,4281545676,4278203340,4294901964,4291559628,4288217292,4284874956,4281532620,4278190284,4294967193,4291624857,4288282521,4284940185,4281597849,4278255513,4294954137,4291611801,4288269465,4284927129,4281584793,4278242457,4294941081,4291598745,4288256409,4284914073,4281571737,4278229401,4294928025,4291585689,4288243353,4284901017,4281558681,4278216345,4294914969,4291572633,4288230297,4284887961,4281545625,4278203289,4294901913,4291559577,4288217241,4284874905,4281532569,4278190233,4294967142,4291624806,4288282470,4284940134,4281597798,4278255462,4294954086,4291611750,4288269414,4284927078,4281584742,4278242406,4294941030,4291598694,4288256358,4284914022,4281571686,4278229350,4294927974,4291585638,4288243302,4284900966,4281558630,4278216294,4294914918,4291572582,4288230246,4284887910,4281545574,4278203238,4294901862,4291559526,4288217190,4284874854,4281532518,4278190182,4294967091,4291624755,4288282419,4284940083,4281597747,4278255411,4294954035,4291611699,4288269363,4284927027,4281584691,4278242355,4294940979,4291598643,4288256307,4284913971,4281571635,4278229299,4294927923,4291585587,4288243251,4284900915,4281558579,4278216243,4294914867,4291572531,4288230195,4284887859,4281545523,4278203187,4294901811,4291559475,4288217139,4284874803,4281532467,4278190131,4294967040,4291624704,4288282368,4284940032,4281597696,4278255360,4294953984,4291611648,4288269312,4284926976,4281584640,4278242304,4294940928,4291598592,4288256256,4284913920,4281571584,4278229248,4294927872,4291585536,4288243200,4284900864,4281558528,4278216192,4294914816,4291572480,4288230144,4284887808,4281545472,4278203136,4294901760,4291559424,4288217088,4284874752,4281532416,4278190318,4278190301,4278190267,4278190250,4278190216,4278190199,4278190165,4278190148,4278190114,4278190097,4278251008,4278246656,4278237952,4278233600,4278224896,4278220544,4278211840,4278207488,4278198784,4278194432,4293787648,4292673536,4290445312,4289331200,4287102976,4285988864,4283760640,4282646528,4280418304,4279304192,4293848814,4292730333,4290493371,4289374890,4287137928,4286019447,4283782485,4282664004,4280427042,4279308561],n={MAGIC:"VOX ",VERSION:150};e.LoadVox=function(a,i){var r,s,l,d=[],c=null,h=[a.getChar(),a.getChar(),a.getChar(),a.getChar()].join("");if(h!=n.MAGIC)return console.error("Bad magic, was "+h+" should be "+n.MAGIC),null;var u=a.getInt32();if(u>n.VERSION)return console.error("Bad version, please use "+n.VERSION+", file had "+u),null;var m=t(a);if("MAIN"==m.id)for(;a.tell()<i;){var p=t(a);if("SIZE"==p.id)r=a.getUint32(),s=a.getUint32(),l=a.getUint32();else if("XYZI"==p.id)for(var E=a.getInt32(),v=0;E>v;v++){var f={};f.x=a.getUint8(),f.y=a.getUint8(),f.z=a.getUint8(),f.colorIdx=a.getUint8(),d.push(f)}else if("RGBA"==p.id){c=[];for(var v=0;255>v;v++)c.push(a.getUint32());a.getUint32()}else console.log("Skipping unknown chunk: "+p.is),a.skip(p.size)}var g={};g.dims={x:r,y:s,z:l},g.palette=[],g.voxels=new Uint8Array(r*s*l);for(var v=0;v<d.length;v++){var f=d[v];g.voxels[e.get3dArrayIdx(g.dims,f.x,f.y,f.z)]=f.colorIdx}return g.palette=null!=c?c:o,g.nullColor=0,g.numColors=256,g.rotateY=270,[g]}}(Voxii),function(e){e.LoadSlab=function(t,o){var n={};n.dims={x:t.getInt32(),y:t.getInt32(),z:t.getInt32()},n.voxels=new Uint8Array(n.dims.x*n.dims.y*n.dims.z);for(var a=0;a<n.dims.x;a++)for(var i=0;i<n.dims.y;i++)for(var r=n.dims.z;r>0;r--){var s=e.get3dArrayIdx(n.dims,a,i,r-1),l=t.getUint8();n.voxels[s]=l}n.palette=[];for(var s=0;256>s;s++){var d=t.getUint8()|(255&t.getUint8())<<8|(255&t.getUint8())<<16|255<<24;n.palette.push(d)}return n.nullColor=255,n.numColors=256,n.rotateY=270,[n]}}(Voxii),function(e){e.LoadQb=function(t,o){for(var n=(t.getInt32(),t.getInt32(),t.getInt32()),a=t.getInt32(),i=(t.getInt32(),t.getInt32()),r=[],s=0;i>s;s++){{var l={};t.getString(t.getUint8())}l.dims={x:t.getUint32(),y:t.getUint32(),z:t.getUint32()},l.pos={x:t.getInt32(),y:t.getInt32()+l.dims.y/2,z:t.getInt32()};var d=function(e){var t=e>>24&255,o=l.palette.indexOf(e);return-1==o&&(l.palette.push(e),o=l.palette.length-1),o=0==t?255:o};if(l.voxels=new Uint8Array(l.dims.x*l.dims.y*l.dims.z),l.palette=[],0==a)for(c=0;c<l.dims.z;c++)for(E=0;E<l.dims.y;E++)for(p=0;p<l.dims.x;p++)l.voxels[e.get3dArrayIdx(l.dims,p,E,c)]=d(t.getUint32());else for(var c=0;c<l.dims.z;c++)for(var h=0;;){var u=t.getUint32();if(6==u)break;if(2==u){var m=t.getUint32();for(u=t.getUint32(),j=0;j<m;j++){var p=h%l.dims.x,E=Math.floor(h/l.dims.x);h++,l.voxels[e.get3dArrayIdx(l.dims,p,E,c)]=d(u)}}else{var p=h%l.dims.x,E=Math.floor(h/l.dims.x);h++,l.voxels[e.get3dArrayIdx(l.dims,p,E,c)]=d(u)}}l.nullColor=255,l.numColors=l.palette.length,l.rotateY=0==n?0:270,r.push(l)}return r}}(Voxii),function(e){function t(e,t){var n=t.clientWidth,a=t.clientHeight,r=document.createElement("canvas");r.width=n,r.height=a,r.style.zIndex=5;var l=o(r);l.clickDiv=i(t,l),t.appendChild(r),l.conf={modelPath:t.getAttribute("data-VoxiiModel")},s.push(l)}function o(t){var o={renderer:null,scene:null,camera:null,controls:null,voxModel:null};o.renderer=new THREE.WebGLRenderer({canvas:t,antialias:!0,alpha:e.EmbedConf.TransparentCanvas}),o.renderer.setSize(t.width,t.height),o.renderer.shadowMapEnabled=!0,o.renderer.shadowMapSoft=!0,o.scene=new THREE.Scene,o.camera=new THREE.PerspectiveCamera(e.EmbedConf.Fov,t.width/t.height,5,3e3),o.camera.position.set(-30,20,30),o.camera.lookAt(o.scene.position),o.controls=new THREE.OrbitControls(o.camera,t),o.controls.damping=.2,o.controls.addEventListener("change",function(){o!=l&&n(o),a()});var i=new THREE.AmbientLight(6710886);i.color.setRGB(.1718,.1952,.2),o.scene.add(i);var r=new THREE.SpotLight(9099519);r.position.set(75,70,80),r.target.position.set(0,0,0),r.shadowCameraNear=1,r.shadowCameraFar=200,r.shadowCameraVisible=!0,r.intensity=.4,o.scene.add(r);var s=new THREE.SpotLight(16738682);s.position.set(0,50,-80),s.target.position.set(0,0,0),s.shadowCameraNear=1,s.shadowCameraFar=200,s.shadowCameraVisible=!0,s.intensity=.5,o.scene.add(s);var d=new THREE.SpotLight(16187284);d.position.set(-75,70,80),d.target.position.set(0,2.5,0),d.shadowCameraNear=1,d.shadowCameraFar=200,d.castShadow=!0,d.intensity=.9,d.shadowMapWidth=2048,d.shadowMapHeight=2048;var c=50;return d.shadowCameraLeft=-c,d.shadowCameraRight=c,d.shadowCameraTop=c,d.shadowCameraBottom=-c,d.shadowCameraFar=3500,d.shadowBias=-1e-4,d.shadowDarkness=.35,o.scene.add(d),o}function n(t){l&&(l.clickDiv.style.visibility="visible",l.scene.remove(l.voxModel),l.voxModel=null,a()),e.LoadModel(t.conf.modelPath,function(e,o){t.clickDiv.style.visibility="hidden",l=t,l.voxModel=e,l.scene.add(l.voxModel),a()})}function a(){l&&l.renderer.render(l.scene,l.camera)}function i(e,t){var o=document.createElement("div");o.style.position="absolute";var a=document.createElement("div");return o.appendChild(a),a.style.width=e.clientWidth+"px",a.style.height="100px",a.style.position="relative",a.style["float"]="left",a.style.top=e.clientHeight/2-50+"px",a.style.background="rgba(1, 1, 1, 0.8)",a.style.color="white",a.style.fontSize="30px",a.style.textAlign="center",a.style.fontFamily="Helvetica",a.style.lineHeight="100px",a.style.userSelect="none",a.style.MozUserSelect="none",a.style.webkitUserSelect="none",a.innerHTML="Click to load model",a.onclick=function(){n(t)},e.appendChild(o),o}function r(){if(requestAnimationFrame(r),l){{d.getDelta()}l.controls.update()}}var s=[],l=null,d=new THREE.Clock;e.EmbedConf={Classname:"VoxiiEmbed",Background:"resources/embedBG.jpg",TransparentCanvas:!0,Fov:75},e.CreateEmbeds=function(){console.log("CreateEmbeds");for(var o=document.querySelectorAll("."+e.EmbedConf.Classname),n=0;n<o.length;n++)t(e.EmbedConf,o[n]);r(),a()}}(Voxii),THREE.OrbitControls=function(e,t){function o(){return 2*Math.PI/60/60*p.autoRotateSpeed}function n(){return Math.pow(.95,p.zoomSpeed)}function a(e){if(p.enabled!==!1){if(e.preventDefault(),e.button===p.mouseButtons.ORBIT){if(p.noRotate===!0)return;N=U.ROTATE,v.set(e.clientX,e.clientY)}else if(e.button===p.mouseButtons.ZOOM){if(p.noZoom===!0)return;N=U.DOLLY,R.set(e.clientX,e.clientY)}else if(e.button===p.mouseButtons.PAN){if(p.noPan===!0)return;N=U.PAN,y.set(e.clientX,e.clientY)}N!==U.NONE&&(document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",r,!1),p.dispatchEvent(V))}}function i(e){if(p.enabled!==!1){e.preventDefault();var t=p.domElement===document?p.domElement.body:p.domElement;if(N===U.ROTATE){if(p.noRotate===!0)return;f.set(e.clientX,e.clientY),g.subVectors(f,v),p.rotateLeft(2*Math.PI*g.x/t.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*g.y/t.clientHeight*p.rotateSpeed),v.copy(f)}else if(N===U.DOLLY){if(p.noZoom===!0)return;C.set(e.clientX,e.clientY),H.subVectors(C,R),H.y>0?p.dollyIn():H.y<0&&p.dollyOut(),R.copy(C)}else if(N===U.PAN){if(p.noPan===!0)return;b.set(e.clientX,e.clientY),x.subVectors(b,y),p.pan(x.x,x.y),y.copy(b)}N!==U.NONE&&p.update()}}function r(){p.enabled!==!1&&(document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",r,!1),p.dispatchEvent(k),N=U.NONE)}function s(e){if(p.enabled!==!1&&p.noZoom!==!0&&N===U.NONE){e.preventDefault(),e.stopPropagation();var t=0;void 0!==e.wheelDelta?t=e.wheelDelta:void 0!==e.detail&&(t=-e.detail),t>0?p.dollyOut():0>t&&p.dollyIn(),p.update(),p.dispatchEvent(V),p.dispatchEvent(k)}}function l(e){if(p.enabled!==!1&&p.noKeys!==!0&&p.noPan!==!0)switch(e.keyCode){case p.keys.UP:p.pan(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:p.pan(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:p.pan(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:p.pan(-p.keyPanSpeed,0),p.update()}}function d(e){if(p.enabled!==!1){switch(e.touches.length){case 1:if(p.noRotate===!0)return;N=U.TOUCH_ROTATE,v.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;N=U.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY,n=Math.sqrt(t*t+o*o);R.set(0,n);break;case 3:if(p.noPan===!0)return;N=U.TOUCH_PAN,y.set(e.touches[0].pageX,e.touches[0].pageY);break;default:N=U.NONE}N!==U.NONE&&p.dispatchEvent(V)}}function c(e){if(p.enabled!==!1){e.preventDefault(),e.stopPropagation();var t=p.domElement===document?p.domElement.body:p.domElement;switch(e.touches.length){case 1:if(p.noRotate===!0)return;if(N!==U.TOUCH_ROTATE)return;f.set(e.touches[0].pageX,e.touches[0].pageY),g.subVectors(f,v),p.rotateLeft(2*Math.PI*g.x/t.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*g.y/t.clientHeight*p.rotateSpeed),v.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(N!==U.TOUCH_DOLLY)return;var o=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(o*o+n*n);C.set(0,a),H.subVectors(C,R),H.y>0?p.dollyOut():H.y<0&&p.dollyIn(),R.copy(C),p.update();break;case 3:if(p.noPan===!0)return;if(N!==U.TOUCH_PAN)return;b.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(b,y),p.pan(x.x,x.y),y.copy(b),p.update();break;default:N=U.NONE}}}function h(){p.enabled!==!1&&(p.dispatchEvent(k),N=U.NONE)}this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var u,m,p=this,E=1e-6,v=new THREE.Vector2,f=new THREE.Vector2,g=new THREE.Vector2,y=new THREE.Vector2,b=new THREE.Vector2,x=new THREE.Vector2,T=new THREE.Vector3,w=new THREE.Vector3,R=new THREE.Vector2,C=new THREE.Vector2,H=new THREE.Vector2,M=0,A=0,O=1,I=new THREE.Vector3,L=new THREE.Vector3,S=new THREE.Quaternion,U={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},N=U.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var z=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),P=z.clone().inverse(),j={type:"change"},V={type:"start"},k={type:"end"};this.rotateLeft=function(e){void 0===e&&(e=o()),A-=e},this.rotateUp=function(e){void 0===e&&(e=o()),M-=e},this.panLeft=function(e){var t=this.object.matrix.elements;T.set(t[0],t[1],t[2]),T.multiplyScalar(-e),I.add(T)},this.panUp=function(e){var t=this.object.matrix.elements;T.set(t[4],t[5],t[6]),T.multiplyScalar(e),I.add(T)},this.pan=function(e,t){var o=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var n=p.object.position,a=n.clone().sub(p.target),i=a.length();i*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*e*i/o.clientHeight),p.panUp(2*t*i/o.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(e*(p.object.right-p.object.left)/o.clientWidth),p.panUp(t*(p.object.top-p.object.bottom)/o.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){void 0===e&&(e=n()),p.object instanceof THREE.PerspectiveCamera?O/=e:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*e)),p.object.updateProjectionMatrix(),p.dispatchEvent(j)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(e){void 0===e&&(e=n()),p.object instanceof THREE.PerspectiveCamera?O*=e:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/e)),p.object.updateProjectionMatrix(),p.dispatchEvent(j)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var e=this.object.position;w.copy(e).sub(this.target),w.applyQuaternion(z),u=Math.atan2(w.x,w.z),m=Math.atan2(Math.sqrt(w.x*w.x+w.z*w.z),w.y),this.autoRotate&&N===U.NONE&&this.rotateLeft(o()),u+=A,m+=M,u=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,u)),m=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,m)),m=Math.max(E,Math.min(Math.PI-E,m));var t=w.length()*O;t=Math.max(this.minDistance,Math.min(this.maxDistance,t)),this.target.add(I),w.x=t*Math.sin(m)*Math.sin(u),w.y=t*Math.cos(m),w.z=t*Math.sin(m)*Math.cos(u),w.applyQuaternion(P),e.copy(this.target).add(w),this.object.lookAt(this.target),A=0,M=0,O=1,I.set(0,0,0),(L.distanceToSquared(this.object.position)>E||8*(1-S.dot(this.object.quaternion))>E)&&(this.dispatchEvent(j),L.copy(this.object.position),S.copy(this.object.quaternion))},this.reset=function(){N=U.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(j),this.update()},this.getPolarAngle=function(){return m},this.getAzimuthalAngle=function(){return u},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",a,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",d,!1),this.domElement.addEventListener("touchend",h,!1),this.domElement.addEventListener("touchmove",c,!1),window.addEventListener("keydown",l,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;
//# sourceMappingURL=Voxii.js.map